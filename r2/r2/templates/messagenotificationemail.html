## The contents of this file are subject to the Common Public Attribution
## License Version 1.0. (the "License"); you may not use this file except in
## compliance with the License. You may obtain a copy of the License at
## http://code.reddit.com/LICENSE. The License is based on the Mozilla Public
## License Version 1.1, but Sections 14 and 15 have been added to cover use of
## software over a computer network and provide for limited attribution for the
## Original Developer. In addition, Exhibit A has been modified to be
## consistent with Exhibit B.
##
## Software distributed under the License is distributed on an "AS IS" basis,
## WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for
## the specific language governing rights and limitations under the License.
##
## The Original Code is reddit.
##
## The Original Developer is the Initial Developer.  The Initial Developer of
## the Original Code is reddit Inc.
##
## All portions of the code written by reddit are Copyright (c) 2006-2014
## reddit Inc. All Rights Reserved.
###############################################################################

<%!
    from r2.lib.filters import unsafe
    from r2.lib.template_helpers import update_query
%>
<%namespace file="utils.html" import="md"/>
<html>
  <body style="font-family: 'Open Sans', Helvetica, Arial, sans-serif">
    <table style="background-color: #cee3f8; padding: 20px 0">
      %for message in thing.messages:
        <tr>
          <td style="align:center">
            <table style="background-color: #fff">
              <tr>
                <td colspan="3">
                  <b>${_("Received on %(time)s") % dict(time=message["date"])}</b>
                </td>
              </tr>
              <tr>
                <td width="10px"></td>
                <td colspan="2">
                  %if message["message_type"] == "message":
                    ${_("%(username)s sent you a %(message_type)s!") % dict(username=message["author_name"], message_type=_(message["message_type"]))}
                  %else:
                    ${_("%(username)s made a %(message_type)s!") % dict(username=message["author_name"], message_type=_(message["message_type"]))}
                  %endif
                </td>
              </tr>
              <tr>
                <td width="10px"></td>
                <td width="10px" style="background-color: #eff7ff"></td>
                <td>
                  ${md(message["body"])}
                </td>
              </tr>
              <tr>
                <td width="10px"></td>
                <td colspan="2" style="font-size:small">
                  ${_("View on the web")}: ${unsafe(update_query(message["permalink"], ref_source="email", ref="message_notification", ref_campaign="permalink"))}
                </td>
              </tr>
            </table>
          </td>
        </tr>
      %endfor

      %if thing.more_unread_messages:
        <p>
          ${_("More unread messages are available in your inbox.")}
        </p>
      %endif
    </table>
    <br>
    <a class="unsubscribe-link" href="${thing.unsubscribe_link}">${_("Unsubscribe here")}</a>
  </body>
</html>
